# 理解度チェッククイズ仕様

## 概要

各章の最後に設置する理解度確認用クイズ。
**即時フィードバック方式**を採用し、選択肢をクリックした瞬間に正誤と解説を表示する。

## 動作仕様

### 基本フロー

```
1. ユーザーが選択肢をクリック
   ↓
2. 即座に正誤を判定・表示
   ↓
3. 選択した選択肢の下に解説を表示
   ↓
4. 次の問題へ進む（自動または手動）
```

### 状態遷移

```
[未回答] → クリック → [回答済み（正解/不正解）] → 全問完了 → [結果表示]
```

## UI仕様

### 問題表示

```
┌─────────────────────────────────────────────┐
│ 問1                                         │
│ Xの推薦システムの設計思想は？                 │
├─────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────┐ │
│ │ A. いいね最大化                          │ │
│ └─────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────┐ │
│ │ B. 滞在時間最大化                    ✓  │ │ ← 正解時は緑背景
│ └─────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────┐ │
│ │ 💡 解説                                 │ │
│ │ Xのアルゴリズムは「滞在時間最大化」を    │ │
│ │ 目的として設計されています。単純な...    │ │
│ └─────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────┐ │
│ │ C. フォロワー最大化                      │ │
│ └─────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────┐ │
│ │ D. 投稿数最大化                         │ │
│ └─────────────────────────────────────────┘ │
└─────────────────────────────────────────────┘
```

### 選択肢の状態

| 状態 | スタイル |
|------|---------|
| 未選択 | `border-border bg-card hover:bg-muted` |
| 正解選択 | `border-green-500 bg-green-50 dark:bg-green-900/20` + ✓アイコン |
| 不正解選択 | `border-red-500 bg-red-50 dark:bg-red-900/20` + ✗アイコン |
| 正解（未選択時表示） | `border-green-500 bg-green-50/50` |
| 無効（回答後） | `opacity-60 pointer-events-none` |

### 解説ボックス

```tsx
<div className="mt-3 p-4 rounded-lg bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800">
  <div className="flex items-start gap-2">
    <LightBulbIcon className="w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5" />
    <div>
      <span className="font-bold text-blue-800 dark:text-blue-300">解説</span>
      <p className="mt-1 text-sm text-blue-700 dark:text-blue-300">
        {explanation}
      </p>
    </div>
  </div>
</div>
```

## データ構造

```typescript
interface QuizQuestion {
  id: number;
  question: string;
  choices: {
    id: string;      // 'A', 'B', 'C', 'D'
    text: string;
  }[];
  correctAnswer: string;  // 'A', 'B', 'C', 'D'
  explanation: string;    // 解説文
}

interface QuizProps {
  questions: QuizQuestion[];
  title?: string;  // デフォルト: "理解度チェック"
}
```

## コンポーネント実装要件

### Props

| プロパティ | 型 | 必須 | 説明 |
|-----------|-----|------|------|
| questions | QuizQuestion[] | ✓ | クイズ問題配列 |
| title | string | - | セクションタイトル |

### State

| 状態 | 型 | 説明 |
|------|-----|------|
| answers | Record<number, string> | 回答済みの問題ID→選択肢ID |
| showExplanation | Record<number, boolean> | 解説表示フラグ |

### 動作

1. 選択肢クリック時
   - `answers` に回答を記録
   - `showExplanation` を `true` に設定
   - 正誤に応じてスタイル変更
   - 解説を該当問題の下に表示

2. 全問回答後
   - スコア表示: `{正解数} / {問題数}`
   - 正解率に応じたメッセージ表示
   - 「もう一度挑戦」ボタン表示

## 結果表示

### スコア計算

```typescript
const score = questions.filter(q => answers[q.id] === q.correctAnswer).length;
const percentage = Math.round((score / questions.length) * 100);
```

### 結果メッセージ

| 正解率 | メッセージ |
|--------|-----------|
| 80%以上 | 素晴らしい！この章の内容をしっかり理解できています。 |
| 60-79% | よくできました！復習すればさらに理解が深まります。 |
| 40-59% | もう一度本文を読み返してから再挑戦してみましょう。 |
| 40%未満 | 本文をじっくり読み直してから挑戦してください。 |

## アクセシビリティ

- キーボード操作: Tab/Enter で選択可能
- スクリーンリーダー: 正誤結果を `aria-live` で通知
- フォーカス管理: 回答後、解説にフォーカス移動
