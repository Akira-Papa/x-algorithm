# 第6章：12種類のフィルターとコンテンツ品質

## 6.1 フィルターとは何か

前章まで、投稿がどのようにスコアリングされるかを解説してきました。しかし、スコアリングの前に通過しなければならない「関門」があります。それが**フィルター**です。

```
【フィルターの位置づけ】

候補投稿（数百万件）
        ↓
┌─────────────────────┐
│                     │
│  12種類のフィルター   │  ← ここで大半が除外
│                     │
└─────────────────────┘
        ↓
フィルター通過（数万件）
        ↓
┌─────────────────────┐
│                     │
│    スコアリング      │
│                     │
└─────────────────────┘
        ↓
最終表示（数十件）
```

フィルターの最も重要な特性は、**バイナリ判定**であることです。

```
【バイナリ判定とは】

スコアリング: 連続値（0.5, 1.2, 3.8 など）
→ スコアが低くても表示される可能性はある

フィルター: 二値（通過 or 除外）
→ 一つでも引っかかれば候補から完全除外
→ スコアが高くても関係ない
```

つまり、どんなに素晴らしいコンテンツでも、フィルターに引っかかれば**誰にも表示されない**のです。

---

## 6.2 コンテンツ品質フィルター（4種類）

コンテンツそのものの品質を判定するフィルターです。

### SafetyFilter（安全性フィルター）

```
【SafetyFilter】

判定対象:
├── 暴力的なコンテンツ
├── ヘイトスピーチ
├── テロリズム関連
├── 自傷・自殺関連
└── 違法行為の助長

判定結果:
├── SAFE: 通過
├── SENSITIVE: 警告付きで通過
└── UNSAFE: 完全除外

※ UNSAFE判定されると、どのユーザーにも表示されない
```

### NsfwFilter（成人向けコンテンツフィルター）

```
【NsfwFilter】

判定対象:
├── 性的なコンテンツ
├── ヌード
├── 性的示唆のある表現
└── 成人向けメディア

判定結果:
├── 一般: 通過
├── 要年齢確認: 年齢確認済みユーザーのみ表示
└── 禁止: 完全除外

※ アカウント設定で「センシティブ」マークが付く可能性
```

### SpamFilter（スパムフィルター）

```
【SpamFilter】

判定対象:
├── 同一内容の大量投稿
├── 自動化された投稿パターン
├── 不自然なリンクの多用
├── フォロー/アンフォローの繰り返し
└── エンゲージメント購入の形跡

判定結果:
├── 正常: 通過
├── 疑わしい: リーチ制限
└── スパム: 完全除外（アカウント凍結の可能性も）

※ 一度スパム判定されると、後の投稿もペナルティを受ける
```

### QualityFilter（品質フィルター）

```
【QualityFilter】

判定対象:
├── コンテンツの情報価値
├── オリジナリティ
├── 文章の読みやすさ
├── メディアの品質
└── 過去の投稿の評価履歴

判定結果:
├── 高品質: 通過（ボーナスの可能性）
├── 標準: 通過
└── 低品質: 除外またはリーチ制限

※ アカウント全体の「品質スコア」にも影響
```

---

## 6.3 ユーザー関係フィルター（3種類）

ユーザー間の関係性に基づくフィルターです。

### BlockedFilter（ブロックフィルター）

```
【BlockedFilter】

判定ロジック:
if user_A.blocked(author_B) OR author_B.blocked(user_A):
    return EXCLUDE  # 完全除外

動作:
├── あなたがブロックした相手の投稿 → 表示されない
├── あなたをブロックした相手の投稿 → 表示されない
└── 双方向で完全に遮断

※ ブロックは最も強い関係遮断
```

### MutedFilter（ミュートフィルター）

```
【MutedFilter】

判定ロジック:
if user_A.muted(author_B):
    return EXCLUDE  # 除外
if user_A.muted_keywords.match(tweet.content):
    return EXCLUDE  # キーワードミュートも適用

動作:
├── ミュートした相手の投稿 → 表示されない
├── ミュートしたキーワードを含む投稿 → 表示されない
└── 相手はあなたをミュートしたことを知らない

※ ブロックより緩い関係調整
```

### FollowFilter（フォロー関係フィルター）

```
【FollowFilter】

判定ロジック:
# 「フォロー中のみ表示」設定の場合
if user.settings.following_only:
    if !user.following(author):
        return EXCLUDE

# 通常は除外ではなく、OON Scorerでペナルティ

動作:
├── 「フォロー中のみ」設定 → 非フォロワーの投稿除外
├── 通常設定 → フィルターは通過、スコアで調整
└── ユーザーの好みに応じた表示調整

※ これはユーザー設定依存
```

---

## 6.4 コンテンツタイプフィルター（3種類）

コンテンツの種類や属性に基づくフィルターです。

### MediaTypeFilter（メディアタイプフィルター）

```
【MediaTypeFilter】

判定対象:
├── テキストのみ
├── 画像付き
├── 動画付き
├── GIF付き
├── リンク付き
└── 投票付き

動作:
├── ユーザーの好みを学習
├── 好まないメディアタイプはスコア減
├── 完全除外は稀（主にスコア調整）
└── 「動画を見たくない」ユーザーには動画を優先しない

※ 除外よりスコア調整が主
```

### LanguageFilter（言語フィルター）

```
【LanguageFilter】

判定ロジック:
user_languages = user.preferred_languages  # 例: ["ja", "en"]
tweet_language = detect_language(tweet)    # 例: "fr"

if tweet_language not in user_languages:
    # 完全除外ではなく、大幅スコア減
    score *= 0.1

動作:
├── ユーザーの言語設定を参照
├── 言語不一致は大幅なスコア減（実質除外に近い）
├── 多言語ユーザーは複数言語を受信
└── 言語検出が不正確な場合もある

※ 日本語ユーザーには日本語投稿が優先
```

### TopicFilter（トピックフィルター）

```
【TopicFilter】

判定対象:
├── 投稿のトピック分類
├── ユーザーの興味トピック
├── 「興味なし」フィードバック履歴
└── トピックのフォロー/ミュート設定

動作:
├── ユーザーがフォローしたトピック → 優先表示
├── 「興味なし」したトピック → 除外
├── 明示的にミュートしたトピック → 完全除外
└── 暗黙の興味トピック → スコア調整

※ ユーザーの明示的設定が最優先
```

---

## 6.5 時間・鮮度フィルター（2種類）

時間に関連するフィルターです。

### FreshnessFilter（鮮度フィルター）

```
【FreshnessFilter】

判定ロジック:
tweet_age = now() - tweet.created_at

if tweet_age > 48_hours:
    return EXCLUDE  # 原則除外（例外あり）

if tweet_age > 24_hours:
    score *= 0.5  # 大幅スコア減

if tweet_age < 1_hour:
    score *= 1.2  # 新鮮さボーナス

例外:
├── バズっている投稿は48時間超でも表示
├── フォロワーの反応が強い投稿は延命
└── 「おすすめ」タブでは古い投稿も表示されやすい

※ 基本は24時間以内の投稿が優先
```

### DuplicateFilter（重複フィルター）

```
【DuplicateFilter】

判定対象:
├── 完全一致の投稿
├── 類似度の高い投稿
├── 同じリンク・メディアを含む投稿
└── リポスト・引用RTの重複

動作:
├── 同一内容を複数回投稿 → 後の投稿を除外
├── 類似投稿が多い → スパム疑い
├── リポストは1回だけ表示
└── 引用RTは独自コンテンツとして扱う

※ 「同じ内容を何度も投稿」は厳禁
```

---

## 6.6 フィルター回避の鉄則

フィルターに引っかからないための鉄則をまとめます。

### 絶対に避けるべきこと

```
【フィルター除外の原因となる行為】

SafetyFilter対策:
✗ 暴力的・攻撃的な表現
✗ 差別的・ヘイト的な内容
✗ 違法行為の助長・教唆

SpamFilter対策:
✗ 同一内容の繰り返し投稿
✗ 短時間での大量投稿
✗ 不自然なリンクの多用
✗ フォロー/アンフォローの繰り返し

QualityFilter対策:
✗ 意味のない短文の連投
✗ 他人のコンテンツのコピペ
✗ クリックベイト的なタイトル
```

### 意識すべきこと

```
【フィルター通過のためのベストプラクティス】

言語:
○ 投稿言語とターゲット層の言語を一致させる
○ 日本語アカウントなら日本語で投稿
○ 多言語投稿は分けて投稿

鮮度:
○ 定期的に新しい投稿をする
○ 24時間以内の投稿が最も有利
○ 古いコンテンツの再投稿は避ける

重複:
○ 毎回オリジナルの内容を投稿
○ 過去の投稿の焼き直しは避ける
○ 引用RTなら独自の意見を追加
```

### フィルターの重要な特性

```
【覚えておくべきフィルターの特性】

1. バイナリ判定
   → 通過か除外か、中間はない
   → スコアが高くても除外されたら終わり

2. 累積効果
   → 一度スパム判定されると、後の投稿も疑われる
   → アカウント全体の「信頼スコア」に影響

3. 復旧の難しさ
   → 一度除外されると、復旧に時間がかかる
   → 予防が最重要

4. 透明性の欠如
   → フィルターに引っかかっても通知されない
   → 自分では気づきにくい
```

---

## 6.7 この章のまとめ

```
【第6章 重要ポイント】

✓ フィルターは「バイナリ判定」
  → 通過か除外か、スコアは関係ない

✓ 12種類のフィルターが存在
  → 品質(4) + 関係(3) + タイプ(3) + 時間(2)

✓ 一つでも引っかかれば完全除外
  → どんなに良い投稿でも表示されない

✓ 予防が最重要
  → 一度除外されると復旧が困難
```

```
【フィルター回避チェックリスト】

□ 暴力的・攻撃的な表現を避ける
□ 同一内容の繰り返しを避ける
□ 短時間での大量投稿を避ける
□ 投稿言語をターゲットに合わせる
□ 24時間以内の新鮮なコンテンツを投稿
□ オリジナルの内容を心がける
□ ブロック・ミュートされる行為を避ける
```

---

**次章予告**: 第7章では、フォロワー（IN）と非フォロワー（OON）の扱いの違いについて、より深く解説します。フォロワー戦略の核心が明らかになります。

---

[← 第5章に戻る](./chapter-05-scoring.md) | [目次](./README.md) | [第7章へ進む →](./chapter-07-in-oon.md)
