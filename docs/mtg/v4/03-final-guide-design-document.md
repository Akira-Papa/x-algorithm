# X攻略マスターガイド 最終詳細設計書

**バージョン**: Final v4.0
**作成日**: 2024年
**作成者**: マコト、タクミ、リサ、ユウキ
**ステータス**: 出版準備完了

---

## 1. ドキュメント概要

### 1.1 目的

本設計書は、「X攻略マスターガイド」全12章の最終仕様を定義し、執筆者が一貫した品質で各章を執筆するための詳細な指針を提供する。

### 1.2 対象読者

- Xでビジネス成長を目指す経営者・マーケター
- インフルエンサーを目指すクリエイター
- SNSマーケティング担当者
- 個人ブランディングを強化したいビジネスパーソン

### 1.3 前提知識

- Xの基本操作（投稿、リプライ、リポスト等）ができる
- Web/アプリの基本的な利用経験がある
- プログラミング知識は不要

---

## 2. 全体構成

### 2.1 12章構成マップ

```
【X攻略マスターガイド 全体構成】

┌─────────────────────────────────────────────────────────────┐
│                    基礎理解パート（1-4章）                   │
├─────────────────────────────────────────────────────────────┤
│ 第1章: 全体像     │ 第2章: エンゲージ │ 第3章: Two-Tower  │
│ └─システム思想    │ └─19種類の重み   │ └─発見メカニズム  │
├───────────────────┴──────────────────┴────────────────────┤
│ 第4章: Phoenix MLモデル                                     │
│ └─Transformer、Candidate Isolation、予測メカニズム          │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│                    技術詳解パート（5-9章）                   │
├─────────────────────────────────────────────────────────────┤
│ 第5章: スコアリング  │ 第6章: フィルター │ 第7章: IN/OON   │
│ └─複合スコア計算     │ └─12種類の門番    │ └─フォロワー戦略│
├──────────────────────┴──────────────────┴───────────────────┤
│ 第8章: Author Diversity │ 第9章: 動画VQV                    │
│ └─投稿タイミング最適化  │ └─動画コンテンツ戦略              │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│                    実践応用パート（10-12章）                 │
├─────────────────────────────────────────────────────────────┤
│ 第10章: 投稿テンプレート │ 第11章: アカウント設計           │
│ └─5種類の成功パターン    │ └─ブランディング戦略             │
├──────────────────────────┴──────────────────────────────────┤
│ 第12章: データ分析と継続的改善                              │
│ └─KPI設計、PDCAサイクル、長期成長戦略                       │
└─────────────────────────────────────────────────────────────┘
```

### 2.2 章間依存関係

```
第1章（必須基盤）
    ├── 第2章 ← 第1章の「スコアリング」概念が前提
    ├── 第3章 ← 第1章の「パイプライン」概念が前提
    └── 第4章 ← 第1章の「Phoenix」概念が前提

第2章 + 第3章 + 第4章
    ├── 第5章 ← 2,3,4章の統合理解が前提
    └── 第6章 ← 2章のエンゲージメント理解が前提

第5章 + 第6章
    ├── 第7章 ← 5章のスコア計算理解が前提
    ├── 第8章 ← 5章のスコア減衰理解が前提
    └── 第9章 ← 5章のVQVスコア理解が前提

第7章 + 第8章 + 第9章
    ├── 第10章 ← 7-9章の戦略理解が前提
    └── 第11章 ← 7章のIN/OON理解が前提

第10章 + 第11章
    └── 第12章 ← 全章の統合が前提
```

---

## 3. 各章詳細仕様

### 3.1 第1章：Xアルゴリズムの全体像と思想

**章の目的**: 読者に推薦システムの全体構造と設計思想を理解させる

**必須コンテンツ**:
```
□ 3層アーキテクチャ図（Home Mixer → Thunder → Phoenix）
□ 8段階パイプライン概要
□ 「滞在時間最大化」という設計思想
□ 2023年オープンソース化の背景
□ Grok Transformerの概要紹介
```

**キーメッセージ**:
> Xは「バズった投稿を見せる」のではなく、「あなたが長く滞在する投稿を見せる」システムである

**技術参照ソース**:
- `thunder/src/pipeline/mod.rs` - パイプライン定義
- `README.md` - システム概要

**想定文字数**: 5,500字

**章構成**:
```
1.1 なぜアルゴリズムを理解すべきか（500字）
1.2 Xの設計思想：滞在時間最大化（800字）
1.3 3層アーキテクチャの全体像（1,200字）
    - Home Mixer（リクエスト処理）
    - Thunder（パイプライン実行）
    - Phoenix（ML予測）
1.4 8段階パイプラインの流れ（1,500字）
1.5 オープンソース化と透明性（500字）
1.6 この章のまとめ（300字）
1.7 次章への橋渡し（200字）
```

---

### 3.2 第2章：エンゲージメント19種類の完全解説

**章の目的**: 19種類のエンゲージメントとその重み付けを完全に理解させる

**必須コンテンツ**:
```
□ 全19種類の完全リスト（重み付き）
□ ポジティブ15種類の詳細解説
□ ネガティブ4種類の詳細解説
□ 重みの意味と戦略的含意
□ よくある誤解の訂正
```

**キーデータ（weighted_scorer.rsより）**:
```rust
// 必ず正確に記載する重み
replied: 13.5           // リプライ - 最重要
profile_clicked: 12.0   // プロフィールクリック
followed: 4.0           // フォロー
video_quality_view: 1.5 // VQV
quoted: 1.1             // 引用RT
retweeted: 1.0          // リポスト
favorited: 0.5          // いいね

reported: -10.0         // 通報
blocked: -10.0          // ブロック
muted: -5.0             // ミュート
not_interested: -1.5    // 興味なし
```

**キーメッセージ**:
> いいね（0.5）よりリプライ（13.5）は27倍重要。100いいねより4リプライの方がアルゴリズム的に高評価

**技術参照ソース**:
- `thunder/src/scorer/weighted_scorer.rs` - 全重み定義

**想定文字数**: 6,000字

**章構成**:
```
2.1 エンゲージメントとは何か（400字）
2.2 ポジティブエンゲージメント15種類（2,500字）
    - 基本インタラクション（いいね、RT、リプライ、引用）
    - 深いエンゲージメント（プロフクリック、詳細展開、動画視聴）
    - フォロー関連（フォロー、通知オン）
    - その他（リンク、ブックマーク、外部共有、滞在時間）
2.3 ネガティブエンゲージメント4種類（1,000字）
2.4 重みの戦略的含意（1,200字）
2.5 よくある誤解と正解（600字）
2.6 この章のまとめ（300字）
```

---

### 3.3 第3章：Two-Tower検索とコンテンツ発見

**章の目的**: コンテンツが「発見」される仕組みを理解させる

**必須コンテンツ**:
```
□ Two-Towerアーキテクチャ図解
□ User Tower（ユーザーベクトル化）の仕組み
□ Content Tower（コンテンツベクトル化）の仕組み
□ コサイン類似度によるマッチング
□ 「おすすめ」タブでの発見メカニズム
```

**キーメッセージ**:
> Xは「あなたに似た人が好んだコンテンツ」と「あなたが好みそうなコンテンツの特徴」の両面からマッチングしている

**技術参照ソース**:
- `candidate-pipeline/src/two_tower/` - Two-Tower実装

**想定文字数**: 5,500字

**章構成**:
```
3.1 Two-Towerとは何か（500字）
3.2 User Tower：あなたはどんな人？（1,200字）
    - 過去の行動履歴
    - フォローパターン
    - 興味カテゴリ
3.3 Content Tower：これはどんなコンテンツ？（1,200字）
    - ツイート内容分析
    - 著者情報
    - エンゲージメント履歴
3.4 マッチング：コサイン類似度計算（1,000字）
3.5 発見タブで見つけてもらう戦略（800字）
3.6 この章のまとめ（300字）
```

---

### 3.4 第4章：Phoenix MLモデルの内部構造

**章の目的**: 機械学習によるランキングの仕組みを理解させる（技術者でなくても）

**必須コンテンツ**:
```
□ Phoenix Transformerの役割
□ 入力特徴量の説明（ユーザー、ツイート、著者、コンテキスト）
□ Grok Transformer（8層、16ヘッド）の概念説明
□ Candidate Isolation（候補分離）の重要性
□ 19種類の確率予測出力
```

**キーメッセージ**:
> あなたの投稿は他の候補と「競争」しているのではなく、「このユーザーにとっての価値」で独立評価されている

**技術参照ソース**:
- `phoenix/src/model/recsys_model.py` - モデル定義
- `phoenix/src/model/grok.py` - Transformer実装

**想定文字数**: 5,800字

**章構成**:
```
4.1 機械学習ランキングとは（500字）
4.2 Phoenix Transformerの構造（1,500字）
    - 入力特徴量（4種類の埋め込み）
    - Grok Transformer（8層構造）
    - 出力（19種類の確率）
4.3 Candidate Isolation：公平な評価（1,200字）
    - なぜ候補同士は見えないのか
    - 順序バイアス排除の意味
4.4 予測から表示までの流れ（1,000字）
4.5 MLモデルが意味する戦略的含意（800字）
4.6 この章のまとめ（300字）
```

---

### 3.5 第5章：スコアリングシステム完全攻略

**章の目的**: 複数のスコアラーが組み合わさる仕組みを理解させる

**必須コンテンツ**:
```
□ スコア計算の全体フロー図
□ Phoenix Scorer（ML予測スコア）
□ OON Scorer（0.85倍ペナルティ）
□ Author Diversity Scorer（0.95減衰）
□ VQV Scorer（1.5倍ボーナス）
□ 最終スコア合成の仕組み
```

**キーデータ（ソースコードより）**:
```rust
// 正確に記載すべき数値
OON_PENALTY: 0.85           // フォロー外ペナルティ
DIVERSITY_DECAY: 0.95       // 著者多様性減衰
VQV_BONUS: 1.5              // 動画品質ボーナス
VQV_MIN_DURATION: 10_000    // VQV最低視聴時間(ms)
```

**キーメッセージ**:
> スコアは「足し算」ではなく「掛け算」。一つでも弱い要素があると全体スコアが大きく下がる

**技術参照ソース**:
- `thunder/src/scorer/phoenix_scorer.rs`
- `thunder/src/scorer/oon_scorer.rs`
- `thunder/src/scorer/author_diversity_scorer.rs`

**想定文字数**: 6,000字

**章構成**:
```
5.1 なぜ複数のスコアラーがあるのか（500字）
5.2 Phoenix Scorer：ML予測スコア（1,200字）
5.3 OON Scorer：フォロー外ペナルティ（1,000字）
5.4 Author Diversity Scorer：著者多様性（1,000字）
5.5 VQV Scorer：動画品質評価（800字）
5.6 最終スコアの合成（800字）
5.7 スコアリング攻略チェックリスト（400字）
5.8 この章のまとめ（300字）
```

---

### 3.6 第6章：12種類のフィルターとコンテンツ品質

**章の目的**: フィルターの仕組みと回避方法を理解させる

**必須コンテンツ**:
```
□ 12種類のフィルター完全リスト
□ 各フィルターの判定基準
□ フィルターの「バイナリ性」（通過か除外か）
□ フィルター回避の鉄則
□ ありがちな失敗パターン
```

**12種類のフィルター（必須記載）**:
```
1. SafetyFilter      - 安全性
2. NsfwFilter        - 成人向け
3. SpamFilter        - スパム
4. QualityFilter     - 品質
5. BlockedFilter     - ブロック関係
6. MutedFilter       - ミュート関係
7. FollowFilter      - フォロー関係
8. MediaTypeFilter   - メディアタイプ
9. LanguageFilter    - 言語
10. TopicFilter      - トピック
11. FreshnessFilter  - 鮮度
12. DuplicateFilter  - 重複
```

**キーメッセージ**:
> フィルターは「バイナリ判定」。スコアが高くても一つでも引っかかれば完全除外される

**技術参照ソース**:
- `thunder/src/filter/` ディレクトリ全体

**想定文字数**: 5,500字

**章構成**:
```
6.1 フィルターとは何か（400字）
6.2 コンテンツ品質フィルター（1,200字）
    - SafetyFilter、NsfwFilter、SpamFilter、QualityFilter
6.3 ユーザー関係フィルター（1,000字）
    - BlockedFilter、MutedFilter、FollowFilter
6.4 コンテンツタイプフィルター（1,000字）
    - MediaTypeFilter、LanguageFilter、TopicFilter
6.5 時間・鮮度フィルター（800字）
    - FreshnessFilter、DuplicateFilter
6.6 フィルター回避の鉄則（800字）
6.7 この章のまとめ（300字）
```

---

### 3.7 第7章：IN vs OON - フォロワー戦略の核心

**章の目的**: フォロワー内外の扱いの違いと戦略を理解させる

**必須コンテンツ**:
```
□ IN（In-Network）とOON（Out-of-Network）の定義
□ 15%ペナルティの具体的影響
□ INファーストの重要性
□ 2段階成長戦略（IN → OON展開）
□ フォロワー数別の戦略調整
```

**キーデータ**:
```
IN表示スコア = 基礎スコア × 1.0
OON表示スコア = 基礎スコア × 0.85
```

**キーメッセージ**:
> OON（非フォロワー）への拡散を狙う前に、まずIN（フォロワー）からの強い反応を得ることが前提条件

**技術参照ソース**:
- `thunder/src/scorer/oon_scorer.rs`

**想定文字数**: 5,500字

**章構成**:
```
7.1 INとOONとは何か（500字）
7.2 15%ペナルティの重大性（1,000字）
7.3 INファースト戦略（1,200字）
7.4 2段階成長戦略（1,500字）
    - Phase 1: INファースト（〜1000フォロワー）
    - Phase 2: OON展開（1000フォロワー〜）
7.5 フォロワー数別の戦略調整（800字）
7.6 この章のまとめ（300字）
```

---

### 3.8 第8章：Author Diversity と投稿タイミング

**章の目的**: 投稿頻度と間隔の最適化を理解させる

**必須コンテンツ**:
```
□ Author Diversity Scorerの仕組み
□ 0.95減衰の具体的計算
□ 連投ペナルティの影響
□ 最適投稿間隔の設計
□ 1日の投稿数上限目安
```

**キーデータ（計算式）**:
```
decay_factor = 0.95 ^ same_author_count

同一著者の連続表示:
- 1個目: 1.0（ペナルティなし）
- 2個目: 0.95（5%減）
- 3個目: 0.9025（約10%減）
- 5個目: 0.774（約23%減）
```

**キーメッセージ**:
> 「投稿頻度を上げれば露出が増える」は半分間違い。連投でAuthor Diversityペナルティが累積し、総露出が減少することがある

**技術参照ソース**:
- `thunder/src/scorer/author_diversity_scorer.rs`

**想定文字数**: 5,500字

**章構成**:
```
8.1 Author Diversityとは何か（500字）
8.2 0.95減衰の仕組み（1,000字）
8.3 連投が危険な理由（1,000字）
8.4 最適投稿間隔の設計（1,200字）
8.5 時間帯別投稿戦略（1,000字）
8.6 1日の投稿数ガイドライン（500字）
8.7 この章のまとめ（300字）
```

---

### 3.9 第9章：動画コンテンツとVQV最適化

**章の目的**: 動画コンテンツの評価基準と最適化方法を理解させる

**必須コンテンツ**:
```
□ VQV（Video Quality View）の定義
□ 10秒ルールの詳細
□ VQV判定の3条件（時間、音声、スクロール）
□ 冒頭3秒の重要性
□ 動画KPI目標設定
```

**キーデータ（VQV判定基準）**:
```rust
// VQV判定条件
min_duration = min(10_000ms, video_duration / 2)
audio_enabled = true
not_scrolled_past = true

// VQVボーナス
video_quality_view_weight = 1.5
```

**キーメッセージ**:
> 動画は「10秒視聴」が分水嶺。冒頭3秒で視聴者を掴み、10秒まで引っ張れるかが勝負

**技術参照ソース**:
- `thunder/src/scorer/weighted_scorer.rs` - VQV重み
- `phoenix/src/features/video.py` - 動画特徴量

**想定文字数**: 5,500字

**章構成**:
```
9.1 動画コンテンツの重要性（500字）
9.2 VQVとは何か（800字）
9.3 VQV判定の3条件（1,200字）
9.4 冒頭3秒の設計（1,000字）
9.5 10秒の壁を超える工夫（1,000字）
9.6 動画KPI目標（VQV率40%）（700字）
9.7 この章のまとめ（300字）
```

---

### 3.10 第10章：実践投稿テンプレートと成功パターン

**章の目的**: 具体的な投稿パターンを習得させる

**必須コンテンツ**:
```
□ 5種類の投稿テンプレート
    - 質問誘発型（リプライ狙い）
    - プロフィール誘導型
    - 保存誘発型（ブックマーク狙い）
    - 引用RT誘発型
    - フォロー誘発型
□ 各テンプレートの具体例
□ 使い分けガイドライン
□ 失敗パターンと回避策
```

**キーメッセージ**:
> 投稿には「型」がある。成功パターンを理解し、自分のコンテンツに適用することで再現性が生まれる

**想定文字数**: 6,000字

**章構成**:
```
10.1 なぜテンプレートが有効か（400字）
10.2 テンプレート1：質問誘発型（800字）
10.3 テンプレート2：プロフィール誘導型（800字）
10.4 テンプレート3：保存誘発型（800字）
10.5 テンプレート4：引用RT誘発型（800字）
10.6 テンプレート5：フォロー誘発型（800字）
10.7 テンプレート使い分けガイド（600字）
10.8 失敗パターンと回避策（700字）
10.9 この章のまとめ（300字）
```

---

### 3.11 第11章：アカウント設計とブランディング

**章の目的**: アカウント全体の最適化方法を理解させる

**必須コンテンツ**:
```
□ Trust Score（信頼スコア）の概念
□ Topical Authority（専門性スコア）
□ プロフィール最適化チェックリスト
□ 投稿一貫性の重要性
□ 相互作用パターンの設計
```

**キーメッセージ**:
> アルゴリズムは個々の投稿だけでなく、アカウント全体の「信頼性」と「専門性」も評価している

**想定文字数**: 5,500字

**章構成**:
```
11.1 アカウント評価の仕組み（500字）
11.2 Trust Score：信頼スコア（1,000字）
11.3 Topical Authority：専門性スコア（1,000字）
11.4 プロフィール最適化（1,200字）
11.5 投稿一貫性の設計（800字）
11.6 相互作用パターン（700字）
11.7 この章のまとめ（300字）
```

---

### 3.12 第12章：データ分析と継続的改善

**章の目的**: 測定→改善サイクルを習得させる

**必須コンテンツ**:
```
□ 追跡すべきKPI体系（プライマリ/セカンダリ/健全性）
□ 週次・月次・四半期の分析サイクル
□ PDCAサイクル for X
□ 成功/失敗パターンの特定方法
□ 長期成長ロードマップ
```

**キーメッセージ**:
> 感覚ではなくデータで判断する。継続的な測定と改善が、長期的な成長の唯一の道

**想定文字数**: 6,000字

**章構成**:
```
12.1 なぜデータ分析が必要か（400字）
12.2 追跡すべきKPI体系（1,500字）
    - プライマリKPI（週次）
    - セカンダリKPI（月次）
    - 健全性KPI（四半期）
12.3 分析サイクルの設計（1,200字）
12.4 PDCA for X（1,200字）
12.5 成功/失敗パターンの特定（800字）
12.6 長期成長ロードマップ（600字）
12.7 この章のまとめ（300字）
```

---

## 4. 執筆スタイルガイド

### 4.1 文体規定

```
【基本文体】
- 敬体（です・ます調）を使用
- 一文は60字以内を目安
- 専門用語は初出時に必ず説明

【禁止事項】
- 「〜だと思います」「〜かもしれません」等の曖昧表現
- 根拠のない断定
- 過度な煽り表現

【推奨事項】
- 具体的な数値を多用
- ソースコードからの引用を明記
- 「なぜなら〜」「つまり〜」で論理展開
```

### 4.2 視覚要素ガイド

```
【コードブロック】
- 技術解説には必ずコードブロックを使用
- Rust/Python/擬似コードの使い分け
- コメントで日本語説明を付加

【図表】
- 概念図はアスキーアート
- 数値データは表形式
- フロー図は矢印（→、↓）で表現

【リスト】
- チェックリスト: □ / ✓
- 重要度: ★★★ / ★★ / ★
- 順序: 1. 2. 3.
- 箇条: - / •
```

### 4.3 章構成テンプレート

```markdown
# 第N章：章タイトル

## N.1 導入（なぜこの知識が重要か）
[500字程度]

## N.2 本編セクション1
[1000-1500字]

## N.3 本編セクション2
[1000-1500字]

## N.4 本編セクション3
[1000-1500字]

## N.5 実践への落とし込み
[800字程度]

## N.6 よくある誤解と正解
[500字程度]

## N.7 この章のまとめ
[300字程度]
チェックリスト形式で要点整理

---
**次章予告**: 次章では〜を解説します。
```

---

## 5. 品質基準

### 5.1 技術的正確性

```
【必須チェック項目】
□ ソースコードからの数値引用が正確
□ 技術用語の使い方が一貫
□ 因果関係の説明が論理的
□ 最新のアルゴリズム仕様を反映
```

### 5.2 実用性

```
【必須チェック項目】
□ 各章に「今日からできること」がある
□ 具体的な行動指針が明確
□ 読者レベルに適した説明
□ 実践例が現実的
```

### 5.3 読みやすさ

```
【必須チェック項目】
□ 一文が長すぎない（60字以内目安）
□ 専門用語に説明がある
□ 図表が効果的に使われている
□ 章間の流れが自然
```

---

## 6. ファイル構成

```
docs/guides-final/
├── README.md                    # ガイド全体の目次
├── chapter-01-overview.md       # 第1章
├── chapter-02-engagement.md     # 第2章
├── chapter-03-two-tower.md      # 第3章
├── chapter-04-phoenix.md        # 第4章
├── chapter-05-scoring.md        # 第5章
├── chapter-06-filters.md        # 第6章
├── chapter-07-in-oon.md         # 第7章
├── chapter-08-diversity.md      # 第8章
├── chapter-09-video.md          # 第9章
├── chapter-10-templates.md      # 第10章
├── chapter-11-branding.md       # 第11章
└── chapter-12-analytics.md      # 第12章
```

---

## 7. 最終チェックリスト

### 7.1 出版前チェック

```
【技術レビュー（タクミ担当）】
□ 全ての数値がソースコードと一致
□ 技術説明に誤りがない
□ コードブロックが正確

【実用性レビュー（リサ担当）】
□ 各章に実践的アクションがある
□ 具体例が現実的
□ 読者が明日から使える

【文章レビュー（ユウキ担当）】
□ 文体が一貫している
□ 専門用語の説明が十分
□ 読みやすさが確保されている

【全体レビュー（マコト担当）】
□ 章間の論理的つながり
□ 全体としての完成度
□ 出版クオリティの達成
```

### 7.2 想定成果物

```
【数量】
- 全12章
- 総文字数：約70,000字
- 章平均：約5,800字

【品質目標】
- アルゴリズムカバー率：92%以上
- 技術的正確性：100%
- 実用的アクション：各章3つ以上
```

---

## 8. 改訂履歴

| バージョン | 日付 | 変更内容 |
|-----------|------|----------|
| v1.0 | - | 初版作成（10章構成） |
| v2.0 | - | 章構成見直し、実践章分散 |
| v3.0 | - | 対話形式採用、キャラクター導入 |
| v4.0 | - | 専門家レビュー、12章構成確定、詳細設計完了 |

---

**設計書承認**

- 技術監修: タクミ（シニアエンジニア）✓
- マーケティング監修: マコト（天才マーケター）✓
- グロース監修: リサ（グロースハッカー）✓
- 執筆監修: ユウキ（UXライター）✓

**ステータス: 出版準備完了**
